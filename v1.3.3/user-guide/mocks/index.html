
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://foxssake.github.io/vest/v1.3.3/user-guide/mocks/">
      
      
        <link rel="prev" href="../lifecycle-hooks/">
      
      
        <link rel="next" href="../benchmarking/">
      
      
      <link rel="icon" href="../../assets/vest-favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Mocks - vest</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/mkdocs_puml/puml.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mocks" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="vest" class="md-header__button md-logo" aria-label="vest" data-md-component="logo">
      
  <img src="../../assets/vest-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            vest
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Mocks
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="vest" class="md-nav__button md-logo" aria-label="vest" data-md-component="logo">
      
  <img src="../../assets/vest-logo.png" alt="logo">

    </a>
    vest
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/installing-vest/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installing vest
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/your-first-test/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Your first test
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../writing-tests/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Writing tests
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../test-outcomes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Test outcomes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assertions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Assertions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../editor-commands/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Editor commands
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../parameterized-tests/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parameterized tests
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lifecycle-hooks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lifecycle hooks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Mocks
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Mocks
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#creating-mocks" class="md-nav__link">
    <span class="md-ellipsis">
      Creating mocks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creating mocks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#limitations" class="md-nav__link">
    <span class="md-ellipsis">
      Limitations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#defining-answers" class="md-nav__link">
    <span class="md-ellipsis">
      Defining answers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#asserting-calls" class="md-nav__link">
    <span class="md-ellipsis">
      Asserting calls
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Benchmarking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../capturing-signals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Capturing signals
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../coroutines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Coroutines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../printing-custom-messages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Printing custom messages
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../custom-types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../project-settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Project Settings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../running-from-ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running from the UI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../running-from-cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running from CLI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../running-on-ci/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running on CI
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#creating-mocks" class="md-nav__link">
    <span class="md-ellipsis">
      Creating mocks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creating mocks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#limitations" class="md-nav__link">
    <span class="md-ellipsis">
      Limitations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#defining-answers" class="md-nav__link">
    <span class="md-ellipsis">
      Defining answers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#asserting-calls" class="md-nav__link">
    <span class="md-ellipsis">
      Asserting calls
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="mocks">Mocks</h1>
<p>A common practice is to break down complex behavior into multiple cooperating
classes. When unit testing a class, we don't want to test its dependencies too,
so instead we introduce <a href="http://xunitpatterns.com/Test%20Double.html">test doubles</a>.</p>
<p><em>Vest</em> provides <em>mocks</em> for this purpose. Mocks are objects that implement the
same methods as the original class, but allow you to specify what is returned
and when. In addition, mocks record their method calls, so you can validate
whether a method was called and with what parameters.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">define()</label><label for="__tabbed_1_2">methods</label><label for="__tabbed_1_3">simple-math.gd</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">extends</span><span class="w"> </span><span class="n">VestTest</span>

<span class="k">func</span><span class="w"> </span><span class="n">get_suite_name</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="p">:</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;Mocks&quot;</span>

<span class="k">var</span><span class="w"> </span><span class="n">simple_math</span><span class="p">:</span><span class="w"> </span><span class="n">SimpleMath</span>

<span class="k">func</span><span class="w"> </span><span class="n">suite</span><span class="p">():</span>
<span class="w">  </span><span class="n">on_case_begin</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">func</span><span class="p">(</span><span class="n">__</span><span class="p">):</span>
<span class="w">    </span><span class="n">simple_math</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mock</span><span class="p">(</span><span class="n">SimpleMath</span><span class="p">)</span>

<span class="w">    </span><span class="c1"># Specify default answers</span>
<span class="w">    </span><span class="n">when</span><span class="p">(</span><span class="n">simple_math</span><span class="o">.</span><span class="n">times</span><span class="p">)</span><span class="o">.</span><span class="n">then_return</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span><span class="n">when</span><span class="p">(</span><span class="n">simple_math</span><span class="o">.</span><span class="n">sum</span><span class="p">)</span><span class="o">.</span><span class="n">then_return</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>

<span class="w">  </span><span class="n">test</span><span class="p">(</span><span class="s2">&quot;Return configured answer&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">func</span><span class="p">():</span>
<span class="w">    </span><span class="n">when</span><span class="p">(</span><span class="n">simple_math</span><span class="o">.</span><span class="n">times</span><span class="p">)</span><span class="o">.</span><span class="n">with_args</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">])</span><span class="o">.</span><span class="n">then_return</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="w">    </span><span class="n">expect_equal</span><span class="p">(</span><span class="n">simple_math</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>

<span class="w">  </span><span class="n">test</span><span class="p">(</span><span class="s2">&quot;Method was called at least once&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">func</span><span class="p">():</span>
<span class="w">    </span><span class="n">simple_math</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>

<span class="w">    </span><span class="k">var</span><span class="w"> </span><span class="n">calls</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">get_calls_of</span><span class="p">(</span><span class="n">simple_math</span><span class="o">.</span><span class="n">times</span><span class="p">)</span>
<span class="w">    </span><span class="n">expect_not_empty</span><span class="p">(</span><span class="n">calls</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Method was not called!&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>

<span class="w">  </span><span class="n">test</span><span class="p">(</span><span class="s2">&quot;Method was called with parameters&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">func</span><span class="p">():</span>
<span class="w">    </span><span class="n">simple_math</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="w">    </span><span class="n">expect_contains</span><span class="p">(</span><span class="n">get_calls_of</span><span class="p">(</span><span class="n">simple_math</span><span class="o">.</span><span class="n">times</span><span class="p">),</span><span class="w"> </span><span class="p">[</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">4.0</span><span class="p">])</span>
<span class="w">  </span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">extends</span><span class="w"> </span><span class="n">VestTest</span>

<span class="k">func</span><span class="w"> </span><span class="n">get_suite_name</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">String</span><span class="p">:</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;Mocks&quot;</span>

<span class="k">var</span><span class="w"> </span><span class="n">simple_math</span><span class="p">:</span><span class="w"> </span><span class="n">SimpleMath</span>

<span class="k">func</span><span class="w"> </span><span class="n">before_case</span><span class="p">(</span><span class="n">__</span><span class="p">):</span>
<span class="w">  </span><span class="n">simple_math</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mock</span><span class="p">(</span><span class="n">SimpleMath</span><span class="p">)</span>

<span class="w">  </span><span class="c1"># Specify default answers</span>
<span class="w">  </span><span class="n">when</span><span class="p">(</span><span class="n">simple_math</span><span class="o">.</span><span class="n">times</span><span class="p">)</span><span class="o">.</span><span class="n">then_return</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="w">  </span><span class="n">when</span><span class="p">(</span><span class="n">simple_math</span><span class="o">.</span><span class="n">sum</span><span class="p">)</span><span class="o">.</span><span class="n">then_return</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="k">func</span><span class="w"> </span><span class="n">test_return_configured_answer</span><span class="p">():</span>
<span class="w">  </span><span class="n">when</span><span class="p">(</span><span class="n">simple_math</span><span class="o">.</span><span class="n">times</span><span class="p">)</span><span class="o">.</span><span class="n">with_args</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">])</span><span class="o">.</span><span class="n">then_return</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="w">  </span><span class="n">expect_equal</span><span class="p">(</span><span class="n">simple_math</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span>

<span class="k">func</span><span class="w"> </span><span class="n">test_method_was_called_at_least_once</span><span class="p">():</span>
<span class="w">  </span><span class="n">simple_math</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>

<span class="w">  </span><span class="k">var</span><span class="w"> </span><span class="n">calls</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">get_calls_of</span><span class="p">(</span><span class="n">simple_math</span><span class="o">.</span><span class="n">times</span><span class="p">)</span>
<span class="w">  </span><span class="n">expect_not_empty</span><span class="p">(</span><span class="n">calls</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Method was not called!&quot;</span><span class="p">)</span>

<span class="k">func</span><span class="w"> </span><span class="n">test_method_was_called_with_parameters</span><span class="p">():</span>
<span class="w">  </span><span class="n">simple_math</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
<span class="w">  </span><span class="n">expect_contains</span><span class="p">(</span><span class="n">get_calls_of</span><span class="p">(</span><span class="n">simple_math</span><span class="o">.</span><span class="n">times</span><span class="p">),</span><span class="w"> </span><span class="p">[</span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">4.0</span><span class="p">])</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="k">extends</span><span class="w"> </span><span class="n">RefCounted</span>
<span class="k">class_name</span><span class="w"> </span><span class="n">SimpleMath</span>

<span class="k">func</span><span class="w"> </span><span class="n">times</span><span class="p">(</span><span class="n">a</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nb nb-Type">float</span><span class="p">:</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">b</span>

<span class="k">func</span><span class="w"> </span><span class="n">sum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">):</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="creating-mocks">Creating mocks</h2>
<p>Call <code>mock()</code> with the desired class, and it will return a mocked instance.</p>
<p>Under the hood, <em>vest</em> creates a new class that extends the class being mocked.
This mock class will record all function calls, and delegate them to the
defined answers.</p>
<h3 id="limitations">Limitations</h3>
<p>Inner classes are not supported at the moment.</p>
<p>Built-in classes are not supported at the moment.</p>
<p>Default values in methods might not work, requiring calls where each parameter
is present.</p>
<p>Since property setters and getters can't be overridden in extending classes,
they are not supported.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Many Godot classes implement <code>get_property()</code> and <code>set_property()</code> methods
and then use those as getters and setters for <code>property</code>. Using this
pattern, <em>vest</em> can mock the getter and setter methods, which would be then
used by the property.</p>
</div>
<h2 id="defining-answers">Defining answers</h2>
<p>Unless an answer is defined for the call, mocked methods won't return anything.
Answers may be defined for any call to the method, or for calls with specific
parameter values. Answers with parameter values take precedence over generic
answers.</p>
<p>Use <code>when()</code> to start defining an answer for a given method call, passing in
the method itself as parameter. Optionally call <code>with_args()</code> on the result, to
specify expected parameter values.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Make sure that the expected parameter values are the right type! In the
example, we intentionally pass in <code>[2.0, 2.0]</code> as expected parameters -
even though <code>[2, 2]</code> is more natural to write, they are ints, and the
method is called with floats, so the answer won't match any calls.</p>
</div>
<dl>
<dt><code>.then_return()</code></dt>
<dd>Returns the value passed in as parameter.</dd>
<dt><code>.then_answer()</code></dt>
<dd>Takes a callable as parameter. Whenever the answer is used, it will call
the specified callable and return its return value. The callable receives
an array, containing the parameters used to call the mocked method.</dd>
</dl>
<h2 id="asserting-calls">Asserting calls</h2>
<p>Use <code>get_calls_of()</code> to retrieve all the calls of a mocked method. Similarly to
<a href="../capturing-signals/">captured signals</a>, the result is an array of arrays, where each individual
array contains the arguments used to call the mocked method.</p>
<p>Since these are just arrays, the <a href="../assertions/">assert library</a> can be used to verify
requirements.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
        <script src="../../assets/mkdocs_puml/puml.js"></script>
      
    
  </body>
</html>